// execute.c
// Author: Joris Hartog
// Date  : 23-11-2015
// St.nr.: SLAE-704

#include <stdio.h>
#include <string.h>

unsigned char egg[] = \
"\x50\x58\x50\x58\x6a\x04\x58\x6a\x01\x5b\x68\x64\x21\x20\x0a\x68\x66\x6f\x75\x6e\x68\x77\x61\x73\x20\x68\x65\x67\x67\x20\x68\x54\x68\x65\x20\x89\xe1\x6a\x14\x5a\xcd\x80\x6a\x01\x58\xcd\x80";

unsigned char egghunter[] = \ 
"\x31\xd2\x66\x81\xca\xff\x0f\x42\x8d\x1a\x6a\x21\x58\xcd\x80\x3c\xf2\x74\xef\xb8\x4f\x58\x50\x58\x40\x39\x02\x75\xea\xff\xe2";

void main() {
	printf("Egghunter length: %d\n", strlen(egghunter));
	printf("Egg length      : %d\n", strlen(egg));
	int (*ret)() = (int(*)())egghunter;
	ret();
}

